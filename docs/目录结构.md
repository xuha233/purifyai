# 项目目录结构详解

```
diskclean/
│
├── README.md              # 项目说明（入口文档）
├── 技术档案.md            # 完整技术文档（对接必读）
├── requirements.txt       # Python 依赖清单
├── settings.json          # 应用配置文件
│
└── src/                   # 源代码目录
    │
    ├── main.py            # 应用程序入口（65行）
    ├── app.py             # 主应用类（370行）
    │
    ├── core/              # 核心业务模块
    │   ├── __init__.py    # 模块导出定义
    │   ├── models.py      # 数据模型（ScanItem等）
    │   ├── scanner.py     # 扫描器基类和具体实现
    │   ├── cleaner.py     # 清理器实现
    │   ├── rule_engine.py # 规则引擎
    │   ├── risk_assessment.py # 风险评估系统
    │   ├── config_manager.py # 配置管理器
    │   ├── database.py    # 数据库操作
    │   ├── whitelist.py   # 白名单管理
    │   ├── permissions.py  # 权限管理
    │   ├── scheduler.py   # 任务调度器
    │   ├── appdata_migration.py # AppData迁移工具
    │   ├── annotation.py # 扫描标注
    │   │
    │   ├── ai_client.py          # AI客户端
    │   ├── ai_enhancer.py        # AI增强器
    │   ├── ai_cache.py           # AI缓存
    │   ├── ai_prompt_builder.py  # AI提示词构建
    │   ├── ai_response_parser.py  # AI响应解析
    │   ├── ai_result_store.py    # AI结果存储
    │   ├── ai_review_models.py   # AI复核模型
    │   │
    │   └── safety/          # 安全模块
    │       ├── custom_recycle_bin.py  # 自定义回收站
    │       ├── preview.py             # 预览功能
    │       └── recovery.py            # 恢复功能
    │
    ├── ui/               # 用户界面模块
    │   ├── dashboard.py          # 仪表板页面
    │   ├── system_cleaner.py      # 系统清理页面
    │   ├── browser_cleaner.py     # 浏览器清理页面
    │   ├── custom_cleaner.py      # 自定义清理页面
    │   ├── settings.py            # 设置页面
    │   ├── history_page.py        # 历史记录页面
    │   ├── recovery_page.py       # 回收站页面
    │   ├── developer_console.py  # 开发者控制台
    │   │
    │   ├── appdata_migration_dialog.py  # 迁移对话框
    │   ├── confirm_dialog.py            # 确认对话框
    │   ├── scan_status_widget.py        # 扫描状态组件
    │   ├── system_tray.py               # 系统托盘
    │   ├── windows_notification.py      # Windows通知
    │   └── whitelist_dialog.py           # 白名单对话框
    │
    ├── utils/           # 工具模块
    │   ├── logger.py        # 日志系统
    │   ├── error_handler.py # 错误处理
    │   ├── debug_monitor.py # 调试监视
    │   └── startup.py       # 开机启动
    │
    ├── data/            # 数据目录
    │   ├── purifyai.db    # SQLite数据库
    │   └── whitelist.json # 白名单配置
    │
    └── docs/            # 文档目录
        └── AI_REVIEW_FIX_PLAN.md  # AI修复计划
```

## 核心模块说明

### src/core/ (核心模块, 30个文件)

| 文件 | 功能 | 主要类/函数 |
|------|------|-----------|
| models.py | 数据模型 | `ScanItem`, `RiskLevel` |
| scanner.py | 扫描器 | `SystemScanner`, `BrowserScanner`, `AppDataScanner` |
| cleaner.py | 清理器 | `Cleaner` |
| rule_engine.py | 规则引擎 | `RuleEngine`, `get_rule_engine` |
| risk_assessment.py | 风险评估 | `RiskAssessmentSystem` |
| config_manager.py | 配置管理 | `ConfigManager`, `get_config_manager` |
| database.py | 数据库 | `Database`, `get_database` |
| whitelist.py | 白名单 | `Whitelist`, `get_whitelist` |
| permissions.py | 权限 | `is_admin`, `request_admin` |
| scheduler.py | 调度器 | `Scheduler` |
| appdata_migration.py | AppData迁移 | `AppDataMigrationTool` |

### src/ui/ (UI模块, 24个文件)

| 文件 | 功能 | 主要类 |
|------|------|--------|
| dashboard.py | 仪表板 | `DashboardPage` |
| system_cleaner.py | 系统清理 | `SystemCleanerPage` |
| browser_cleaner.py | 浏览器清理 | `BrowserCleanerPage` |
| custom_cleaner.py | 自定义清理 | `CustomCleanerPage` |
| settings.py | 设置 | `SettingsPage` |
| history_page.py | 历史 | `HistoryPage` |
| recovery_page.py | 回收站 | `RecoveryPage` |
| developer_console.py | 开发者控制台 | `DeveloperConsolePage` |
| appdata_migration_dialog.py | 迁移对话框 | `AppDataMigrationDialog` |
| system_tray.py | 系统托盘 | `SystemTray` |
| windows_notification.py | 系统通知 | `WindowsNotification` |

### src/utils/ (工具模块, 4个文件)

| 文件 | 功能 |
|------|------|
| logger.py | 日志系统 |
| error_handler.py | 错误处理 |
| debug_monitor.py | 调试监视 |
| startup.py | 开机启动 |

## 文件统计

| 类型 | 数量 |
|------|------|
| Python 文件 | 68 |
| 总文件数 | 104 |
| 总目录数 | 11 |
| 代码行数 (估算) | ~10,000+ |

## 依赖关系

```
main.py (入口)
    ↓
app.py (主应用)
    ↓
├── core/ (业务逻辑)
│   ├── scanner.py, cleaner.py, rule_engine.py, ...
│   └── config_manager.py → JSON配置文件
│
├── ui/ (用户界面)
│   ├── dashboard.py, system_cleaner.py, browser_cleaner.py, ...
│   └── settings.py ← config_manager
│
├── utils/ (工具)
│   ├── logger.py, error_handler.py, ...
│   └── startup.py
│
└── data/ (数据)
    └── purgeifyai.db, whitelist.json
```

## 对接要点

### 关键模块对接

1. **扫描器对接** - `src/core/scanner.py`
   - 继承 `QObjectScanner` 类
   - 实现信号连接

2. **清理器对接** - `src/core/cleaner.py`
   - 使用 `QObjectCleaner` 类

3. **配置管理** - `src/core/config_manager.py`
   - 使用 `get_config_manager()` 获取实例

4. **数据库操作** - `src/core/database.py`
   - 使用 `get_database()` 获取实例

### 技术参数

| 参数 | 值 |
|------|-----|
| Python版本 | 3.14+ |
| GUI框架 | PyQt5 5.15+ |
| UI组件库 | QFluentWidgets 1.0+ |
| 数据库 | SQLite3 |
| 系统要求 | Windows 7+ |
